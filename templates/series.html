{% extends "base.html" %}

{% block title %}Series - BeeMD{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/series.css') }}">
{% endblock %}

{% block content %}
<div class="container series-page">

    <h1>{{ title | default("All Series") }}</h1>

    <form action="{{ url_for('series') }}" method="get">
        
        <div class="search-box">
            <input type="text" name="q" placeholder="Search series title..." value="{{ request.args.get('q') or '' }}">
            <button type="submit">Search</button>
        </div>

        <div class="filters">
            
            <select name="titleType">
                <option value="">All Types</option>
                <option value="tvSeries" {% if request.args.get('titleType') == 'tvSeries' %}selected{% endif %}>TV Series</option>
                <option value="tvMiniSeries" {% if request.args.get('titleType') == 'tvMiniSeries' %}selected{% endif %}>TV Mini Series</option>
            </select>

            <select name="startYear">
                <option value="">Start Year</option>
                <option value="2020" {% if request.args.get('startYear') == '2020' %}selected{% endif %}>2020s</option>
                <option value="2010" {% if request.args.get('startYear') == '2010' %}selected{% endif %}>2010s</option>
                <option value="2000" {% if request.args.get('startYear') == '2000' %}selected{% endif %}>2000s</option>
                <option value="1990" {% if request.args.get('startYear') == '1990' %}selected{% endif %}>1990s</option>
            </select>

             <select name="endYear">
                <option value="">End Year</option>
                <option value="2025" {% if request.args.get('endYear') == '2025' %}selected{% endif %}>Ended 2025+</option>
                <option value="2020" {% if request.args.get('endYear') == '2020' %}selected{% endif %}>Ended 2020+</option>
                <option value="2010" {% if request.args.get('endYear') == '2010' %}selected{% endif %}>Ended 2010+</option>
            </select>

            <select name="runtime">
                <option value="">Runtime</option>
                <option value="lt30" {% if request.args.get('runtime') == 'lt30' %}selected{% endif %}>Short (< 30 min)</option>
                <option value="30-60" {% if request.args.get('runtime') == '30-60' %}selected{% endif %}>Medium (30 - 60 min)</option>
                <option value="gt60" {% if request.args.get('runtime') == 'gt60' %}selected{% endif %}>Long (> 60 min)</option>
            </select>

            <select name="isAdult">
                <option value="">Content Rating</option>
                <option value="0" {% if request.args.get('isAdult') == '0' %}selected{% endif %}>General Audience</option>
                <option value="1" {% if request.args.get('isAdult') == '1' %}selected{% endif %}>Adult Only</option>
            </select>

            <button type="submit" id="filter-btn">Apply Filters</button>
        </div>
    </form>

    <hr style="border-color: rgba(255,255,255,0.1); margin: 25px 0;">

    <div class="series-list">
        {% if items %}
            {% for row in items %}
            <div class="series-item">
                <h3 class="series-title">
                    <a href="{{ url_for('serie_detail', series_id=row.seriesId) }}">
                        {{ row.seriesTitle }} 
                        <span style="font-size: 0.8em; color: #888;">
                            ({{ row.startYear }} - {{ row.endYear if row.endYear else '?' }})
                        </span>
                    </a>
                </h3>
                <div class="series-meta">
                   Type: {{ row.titleType }} | Runtime: {{ row.runtimeMinutes }} min
                   {% if row.isAdult == 1 %} | <span style="color:red; font-size:0.8em; border:1px solid red; padding:0 4px; border-radius:4px;">18+</span> {% endif %}
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="no-results">
                <p>No series found matching your criteria.</p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}